# Flow Log Parser

## Description
This program parses a file containing flow log data and maps each row to a tag based on a lookup table. The lookup table is provided as a CSV file with columns `dstport`, `protocol`, and `tag`. The combination of `dstport` and `protocol` determines the applicable tag for each log entry. The program generates two outputs:
1. A count of matches for each tag.
2. A count of matches for each `port/protocol` combination.

## Assumptions
- The program supports only the default log format, version 2.
- The lookup table and flow log files are plain text (ASCII) files.
- The program processes the logs in a case-insensitive manner for protocol matching.
- The program handles a lookup table with up to 10,000 mappings and a flow log file up to 10 MB in size.

## Files
- `flow_log_parser.py`: The main script that implements the program.
- `lookup_table.csv`: Example lookup table file.
- `flow_logs.txt`: Example flow log file.
- `output.txt`: Output file generated by the program.

## Usage
### Running the Program
1. Ensure Python 3 is installed on your machine.
2. Place the `lookup_table.csv` and `flow_logs.txt` files in the same directory as `flow_log_parser.py`.
3. Run the script using the command:
   ```
   python flow_log_parser.py
   ```
4. The output will be written to `output.txt` in the same directory.

### Modifying Input and Output Files
You can change the input and output file paths by modifying the following lines in `flow_log_parser.py`:
```python
lookup_file = 'lookup_table.csv'  # Replace with your lookup table file path
flow_log_file = 'flow_logs.txt'   # Replace with your flow log file path
output_file = 'output.txt'        # Output file path
```

## Output Format
### Tag Counts
The output file contains a section for tag counts in the following format:
```
Tag Counts:
Tag,Count
sv_P2,1
sv_P1,2
email,3
Untagged,9
```

### Port/Protocol Combination Counts
The output file also includes a section for port/protocol combination counts:
```
Port/Protocol Combination Counts:
Port,Protocol,Count
22,tcp,1
23,tcp,1
25,tcp,1
443,tcp,1
```

## Testing
- The program was tested with sample flow logs and lookup tables provided in the problem statement.
- Various combinations of `dstport` and `protocol` were used to ensure accurate tagging.
- Untagged entries were verified to be counted correctly when no matching tag was found.

## Notes
- Ensure the input files are in the correct format as expected by the program.
- If any clarification is needed, refer to the sample files provided in the repository for guidance.

